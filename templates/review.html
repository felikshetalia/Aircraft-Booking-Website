{% extends 'base.html' %}
{% block page_title %}
    Aircraft Reservation Review
{% endblock %}
{% block content %}
  {% load static %}
  <head>
    <link rel="stylesheet" type="text/css" href="{% static 'css/review.css' %}">
  </head>
  <body>
    <div class="container">
      <div class="first">
         <img src="{{ aircraft.image }}" alt="{{ aircraft.xwmmodel }}">
{#        <img src="https://biznesalert.pl/wp-content/uploads/2019/07/LOT_787_1.jpg" alt="{{ aircraft.xwmmodel }}">#}
        <div class="details">
          <div class="card-body">
            <h3 class="card-title">{{ aircraft.model }}</h3>
            <p class="card-text"><strong>Aircraft ID: </strong>{{ aircraft.id }}</p>
            <p class="card-text"><strong>Fuel Capacity: </strong>{{ aircraft.fuelCapacity }}</p>
            <p class="card-text"><strong>Current Speed: </strong>{{ aircraft.currentSpeed }}</p>
            <p class="card-text"><strong>Availability: </strong>{{ aircraft.availability }}</p>
            <p class="card-text"><strong>Description: </strong>{{ aircraft.description }}</p>
            <p class="card-text"><strong>Country: </strong>{{ aircraft.country }}</p>
          </div>
        </div>
      </div>

      <div class="review-form">
        <h1>Review your renting experience with {{ aircraft.model }}</h1>
        <div class="form-group">
          <div class="rating">
            <span class="star" data-value="1">&#9733;</span>
            <span class="star" data-value="2">&#9733;</span>
            <span class="star" data-value="3">&#9733;</span>
            <span class="star" data-value="4">&#9733;</span>
            <span class="star" data-value="5">&#9733;</span>
          </div>
        </div>
        <div class="form-group">
          <label for="name">Name:</label>
          <input type="text" id="name" placeholder="Enter your name">
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" placeholder="Enter your email">
        </div>
        <textarea id="comment-box" placeholder="Write your comments here"></textarea>
        <button id="submit-btn">Submit</button>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const stars = document.querySelectorAll(".star");
        const ratingValue = document.querySelector("#rating-value");
        const commentBox = document.querySelector("#comment-box");
        const submitBtn = document.querySelector("#submit-btn");

        stars.forEach(function(star) {
          star.addEventListener("click", function() {
            const value = this.getAttribute("data-value");

            stars.forEach(function(star, index) {
              if (index < value) {
                star.classList.add("selected");
              } else {
                star.classList.remove("selected");
              }
            });

            ratingValue.value = value;
          });

          star.addEventListener("mouseover", function() {
            const value = this.getAttribute("data-value");

            stars.forEach(function(star, index) {
              if (index < value) {
                star.classList.add("hover");
              } else {
                star.classList.remove("hover");
              }
            });
          });

          star.addEventListener("mouseout", function() {
            stars.forEach(function(star) {
              star.classList.remove("hover");
            });
          });
        });

        submitBtn.addEventListener("click", function(event) {
          event.preventDefault();

          const rating = ratingValue.value;
          const comment = commentBox.value;
          const name = document.querySelector("#name").value;
          const email = document.querySelector("#email").value;

          console.log("Rating:", rating);
          console.log("Comment:", comment);
          console.log("Name:", name);
          console.log("Email:", email);

          fetch('/save-rating/', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              rating: rating,
              comment: comment,
              name: name,
              email: email,
            }),
          })
          .then(response => response.json())
          .then(data => {
            console.log(data);
            ratingValue.value = "";
            commentBox.value = "";
            document.querySelector("#name").value = "";
            document.querySelector("#email").value = "";
            stars.forEach(function(star) {
              star.classList.remove("selected");
            });
          })
          .catch(error => {
            console.error('Error:', error);
          });
        });
      });
    </script>
  </body>
{% endblock %}
